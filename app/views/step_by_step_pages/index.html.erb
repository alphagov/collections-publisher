<%
  links = [
    {
      text: 'Step by step publisher',
    }
  ]
%>

<%= render 'shared/steps/step_breadcrumb', links: links %>

<%= render 'shared/steps/page_title', links: links %>

<%= render 'shared/steps/form_notice', message: notice, status: "success" %>


<%= render "govuk_publishing_components/components/heading", {
  text: "Step by step navigation publisher",
  margin_bottom: 6
} %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <%= render "govuk_publishing_components/components/button", {
      text: "Create new",
      href: new_step_by_step_page_path
    } %>
  </div>
</div>

<table class="govuk-table govuk-!-margin-top-4">
  <thead class="govuk-table__head">
    <tr>
      <th class="govuk-table__header" scope="col">Title</th>
      <th class="govuk-table__header" scope="col">Slug</th>
      <th class="govuk-table__header" scope="col">Actions</th>
      <th class="govuk-table__header govuk-table__header--numeric" scope="col">Status</th>
    </tr>
  </thead>

  <tbody class="govuk-table__body">
    <% @step_by_step_pages.each do |step_by_step_page| %>
      <tr class="govuk-table__row" data-status="<%= step_by_step_page.status[:name] %>">
        <th class="govuk-table__header" scope="col">
          <%= step_by_step_page.title %>
        </th>
        <td class="govuk-table__cell">
          <%= step_by_step_page.slug %>
        </td>
        <td class="govuk-table__cell">
          <ul class="govuk-list govuk-list--inline">
            <li><%= link_to 'Edit', step_by_step_page %></li>
            <li><%= link_to 'Choose navigation', step_by_step_page_navigation_rules_path(step_by_step_page) %></li>
            <% if step_by_step_page.has_draft? %>
                <li><%= link_to 'Preview', preview_url(step_by_step_page.slug, auth_bypass_id: step_by_step_page.auth_bypass_id) %></li>
            <% end %>
          </ul>
        </td>
        <td class="govuk-table__cell govuk-table__cell--numeric">
          <span class="h4">
            <span class="label <%= step_by_step_page.status[:label_class] %>" title="<%= step_by_step_page.status[:text] %>"><%= step_by_step_page.status[:text] %></span>
          </span>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%
  links = [
    {
      text: 'Step by step publisher',
      href: step_by_step_pages_path
    },
    {
      text: @step_by_step_page.title,
      href: step_by_step_page_path(@step_by_step_page)
    },
    {
      text: 'Choose navigation',
    }
  ]
%>

<%= render 'shared/steps/step_breadcrumb', links: links %>

<%= render 'shared/steps/form_notice', message: notice, status: "success" %>

<%= render 'shared/steps/page_title', links: links %>

<%= render 'shared/steps/heading',
  step_nav: @step_by_step_page.title,
  action: 'Choose on-page side navigation'
%>

<%= render 'step_by_step_pages/nav', step_by_step_page: @step_by_step_page, active:"choose-navigation" %>

<%= form_for(step_by_step_page_navigation_rules_path(@step_by_step_page), method: :put) do |form| %>

  <table class="table table-striped table-stepnav-rules" data-module="filterable-table">
    <thead>
      <tr>
        <th colspan="3">
        <div class='filter-control'>
          <%= render partial: 'govuk_admin_template/table_filter_form', locals: { placeholder: 'Search for a rule here' } %>
        </div>
        </th>
      </tr>
      <tr>
        <th>Page title</th>
        <th>Path</th>
        <th>Sidebar content of page</th>
      </tr>
    </thead>

    <tbody>
      <% @step_by_step_page.navigation_rules.each do |navigation_rule| %>
        <tr>
          <td><%= link_to(navigation_rule.title, preview_url(navigation_rule.base_path)) %></td>
          <td><%= navigation_rule.base_path %></td>
          <td>
            <div class="checkbox">
              <label>
                <%= hidden_field_tag("navigation_rules[#{navigation_rule.content_id}]", false)%>
                <%= check_box_tag( "navigation_rules[#{navigation_rule.content_id}]", true, navigation_rule.include_in_links) %>
                Show this navigation<span class="sr-only"> on '<%= navigation_rule.title %>'</span>
              </label>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <div class="form-group">
    <%= form.submit "Save", class: "btn btn-primary" %>
  </div>
  <div class="form-group">
    <%= link_to "Cancel", @step_page %>
  </div>
<% end %>
